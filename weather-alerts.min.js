// Weather Alerts System
const WeatherAlerts = {
    alerts: [],
    
    init() {
        this.checkWeatherAlerts();
        setInterval(() => this.checkWeatherAlerts(), 300000); // Check every 5 minutes
    },

    checkWeatherAlerts() {
        // Simulate weather alert data
        const mockAlerts = [
            {
                id: 1,
                type: 'drought',
                severity: 'high',
                title: 'Drought Warning',
                message: 'Extended dry period expected in Lubombo region. Farmers advised to conserve water.',
                region: 'Lubombo',
                expires: Date.now() + 86400000 // 24 hours
            }
        ];

        this.alerts = mockAlerts.filter(alert => alert.expires > Date.now());
        this.displayAlerts();
    },

    displayAlerts() {
        if (this.alerts.length === 0) return;

        const alertContainer = document.createElement('div');
        alertContainer.className = 'weather-alerts';
        alertContainer.innerHTML = `
            <div class="alert-banner ${this.alerts[0].severity}">
                <i data-lucide="alert-triangle"></i>
                <span>${this.alerts[0].title}: ${this.alerts[0].message}</span>
                <button onclick="WeatherAlerts.dismissAlert(${this.alerts[0].id})" aria-label="Dismiss alert">Ã—</button>
            </div>
        `;

        const weatherSection = document.getElementById('weather');
        if (weatherSection && !document.querySelector('.weather-alerts')) {
            weatherSection.insertBefore(alertContainer, weatherSection.firstChild);
        }
    },

    dismissAlert(id) {
        this.alerts = this.alerts.filter(alert => alert.id !== id);
        const alertElement = document.querySelector('.weather-alerts');
        if (alertElement) alertElement.remove();
    }
};

document.addEventListener('DOMContentLoaded', () => {
    WeatherAlerts.init();
});