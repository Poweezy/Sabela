// Donation System
const DonationSystem = {
    amounts: [25, 50, 100, 250],
    selectedAmount: null,

    init() {
        this.setupDonationModal();
        this.bindEvents();
    },

    setupDonationModal() {
        const modal = document.getElementById('donationModal');
        if (!modal) return;

        const optionsHtml = this.amounts.map(amount => `
            <div class="donation-option" data-amount="${amount}">
                <div class="donation-amount">$${amount}</div>
                <div class="donation-description">${this.getDescription(amount)}</div>
            </div>
        `).join('');

        const placeholder = modal.querySelector('.donation-placeholder');
        if (placeholder) {
            placeholder.innerHTML = `
                <div class="donation-options">${optionsHtml}</div>
                <button class="btn btn-primary" id="proceedDonate" disabled>Proceed to Payment</button>
            `;
        }
    },

    getDescription(amount) {
        const descriptions = {
            25: 'Plant 5 trees',
            50: 'Train 1 farmer',
            100: 'Solar kit for family',
            250: 'Community workshop'
        };
        return descriptions[amount] || 'Support our mission';
    },

    bindEvents() {
        document.addEventListener('click', (e) => {
            if (e.target.closest('.donation-option')) {
                this.selectAmount(e.target.closest('.donation-option'));
            }
            if (e.target.id === 'proceedDonate') {
                this.processDonation();
            }
        });
    },

    selectAmount(option) {
        document.querySelectorAll('.donation-option').forEach(opt => 
            opt.classList.remove('selected'));
        option.classList.add('selected');
        this.selectedAmount = parseInt(option.dataset.amount);
        document.getElementById('proceedDonate').disabled = false;
    },

    processDonation() {
        if (!this.selectedAmount) return;

        if (typeof gtag !== 'undefined') {
            gtag('event', 'donation_attempt', {
                event_category: 'conversion',
                event_label: `$${this.selectedAmount}`
            });
        }

        // Simulate payment processing
        alert(`Donation of $${this.selectedAmount} - Payment gateway integration needed`);
        document.getElementById('donationModal').style.display = 'none';
    }
};

document.addEventListener('DOMContentLoaded', () => {
    DonationSystem.init();
});